09.02.2017
----------
* rewrite validateLIN with a function
* rewrite Segment TODO with functions
* run on all VGs

* run -D and refstats to get sheets
* use perl to find rs\n errors (replace followed by delete)
* use perl to find deletes of mc|n|pg||
* in this way, eliminate lines from .ref files (backup first)
* work to eliminate sheets
* eliminate Exceptions in b??.txt
* what is then left in .ref files?
* automate check of ERR_LIN(a,b,c), different by error type
* deal with .orig files


7638.lin has absurd trick numbers.  How to detect?
7832.lin has funny pn's embedded.
Detect hands with less than 4 players.
46107 (P): Segment.cpp line 1207, should check that more than 
one set of (eight) names

refstats.pl: Are there unrecognized tags that don't get printed out?

Have to look at tag counts, consistent for each type of LIN_ERR.
Check #lines in .skip against actual line count.

10606.sht has duplicate URLs -- why?

Are there skipped lin files that contain the word "Suggest"? Look at.

Get rid of as many skip files as possible.  Down to 1016 with size 0,
of which 75 generate .sht files.  Look at each of these manually.
In 23085.sht, how is it possible in c31 to have 3 tricks, 0 good,
and yet 26 plays and 0 bad?

In allskips, could write a script to delete .sht files that end on 
"Suggest skip".  That should leave 147 files, of which 75 are the
ones corresponding to 0 .skip file size.  Examine manually.

Then we still have 1016 - 75 = 941 size-0 skip files that
don't generate .sht files.  Probably a bunch of the other
8364 skip files - 1016 = 7348 skip files also don't generate .sht
files and yet have issues.  We need to determine those issues
(or enough of them to eliminate all size-0 sht files).

Same players "at both tables", e.g. 494.lin?


Turn back temporary changes (or on digest, skip input parsing):
- Makefile
- dispatch function

Clean up perl path and @INC

Need exceptions to go into sheet str somehow, not end up
in general output.  The -v 30 input should be clean in the end.

- 30020 addPlay (Card D2 not held)
- 30334 nextLIN (Bad LIN line)
- 30699 setRBN (Malformed RBN team line)
- 30706 addPlay (Invalid card)

-30849: Why DD difference in equality test?

Do doubled contracts get detected in Sheet (always, sometimes,
never)?  E.g. 30502.sht o24

30637 c2: Why shown as "Claim 8"?

ref line modification:
- Expand referr.cpp: classify function


Sheet:
- Another str() function that outputs an IMP sheet,
  will also need vul
- Can be extended to the "rotated" plays in early VG files
- Deal can report #recurring hands out of (up to) 4 cards
- See whether a hand is completely messed up, or only a few
  cards, or only rotations


Complete replacements should go in ref file,
* replace
followed by the new file

Statistics on sources
- Number of (good) hands
- Number of files
  - Perfect
  - Some fixes (say few .ref lines and few .xxx effect lines)
  - Skips

Quality of fixes
- No skip or ref file without a data file (lin to start with)
- No skip file with a ref file
- Incomplete auctions, e.g. 30319.  Some MB_OVERLONG may have to be
  reclassified.
- No duplicates in BBOSH (file names)
- BBOSH files sorted properly into directories
- Detect complete skips
- Fixes in order
- Screenscrape major championships, compare.
- Check links (http, www).


Number of lines:
19,306,468 in LIN_VG
    25,440 in .ref


LIN_VG files with multiple players
- Could be multiple segments
- Could be running changes
- Tolerate whole files or deleted parts of files as well
- Normal play files (6939.lin).

Too harsh fixes especially in BBOVG
- Try multi-threading of BBOVG and also BBOSH
- Fixes should only be for real file errors; program should
  tolerate more
- Fixes might have a fourth entry with the type of fix
- May have deleted whole hands due to single bad cards...
- Maybe tolerate tricks in wrong order within each trick

Too lenient
- No "real" players (West,North,East,South)
- Very expensive bids (offering huge upside score).
- Very expensive or "stupid" plays (quickTricks?).
- Find unrealistic sequences (opening final contract)
- 37865.lin, c32: Why is 2NT, W and 1NT, W not flagged apart?
  (Also perhaps doubled or not?)

Code
- Print example of each validate "error"
- No % comment except LIN_RP and perhaps PBN
- Make prettier line break in LIN print except LIN_RP.
- Buffer should pick up .ref automatically.
- Still segfault at end?
- Allow concatenated files, e.g. RBN but also LIN
- TODOs

Data
- Include BBOVG and BBOSH up to the end of 2016
- Look for more sources?  Later...

update Pavlicek missive and Excel


Functionality
-------------
Named Entity Recognizers for
- Player names
- Tournaments

options
-------
-A analyse DD
-p play analyze DD
-n output all names to appropriately named text files

Makefiles
---------
        compile runs    threads
-------------------------------
visual  yes     yes     yes
cygwin  yes     segf
mingw   almost
clang
ubuntu

Valuation
---------
Board: Valuation

Double-dummy
------------
* Tableau: Call DDS
* Trace: 
  - (1) old trace, can count mistakes
  - (2) new trace, can compare within suit and between suits,
    probably friend of Deal.  Need new DDS function?

How to multi-thread the DDS calls?
Threads consume single boards from segments (all instances).

Database
--------
Be able to store
- Play trace, including error types
- Hand to open bidding (0-4)
- board display number, can check dealer/vul then
- Files, Dirs (or combine?)
- Systems, and some characteristics
- Defenses, and some characteristics

Generate each of the tables in an sqlite DB as txt

Ingest them into sqlite in a separate program

some kind of "make" ("scour") looks for new or changed files.
Output proposed deltas to DB

Find a way to normalize all important text fields.

Should somehow recognize complete duplicates.

Syntax for .bsf files
---------------------
(Bridge script files)
player alias "Display,Last,First" "Display"
select segment "segment"
unselect segment
postpone (rerun in the end, e.g. for partner counts)
select board 7
(stuff to do with the selected board, e.g. contract)
Actually, make it sql-like
